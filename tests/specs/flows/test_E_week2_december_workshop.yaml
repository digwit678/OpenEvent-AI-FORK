{
  "suite": "flow_E_week2_december",
  "initial_clock": "2025-11-25T09:00:00+01:00",
  "steps": [
    {
      "turn": 1,
      "msg_in": {
        "subject": "Week 2 workshop",
        "body": "Hi team,\nFull-day workshop in December, second week (around 10/11), ~22 people. We need a U-shape setup, projector, and coffee service. Location Zurich.\nThanks,\nSophie"
      },
      "expect": {
        "intent": "event_intake",
        "user_info": {
          "city": "Zurich",
          "participants": 22,
          "week_index": 2,
          "window": {
            "month": "December",
            "week_index": 2,
            "weekdays_hint": [
              10,
              11
            ]
          }
        },
        "actions": [
          {
            "type": "select_date",
            "label": "10.12.2025 (09:00–17:00)",
            "date": "2025-12-10",
            "display_date": "10.12.2025"
          },
          {
            "type": "select_date",
            "label": "11.12.2025 (09:00–17:00)",
            "date": "2025-12-11",
            "display_date": "11.12.2025"
          },
          {
            "type": "select_date",
            "label": "08.12.2025 (09:00–17:00)",
            "date": "2025-12-08",
            "display_date": "08.12.2025"
          },
          {
            "type": "select_date",
            "label": "09.12.2025 (09:00–17:00)",
            "date": "2025-12-09",
            "display_date": "09.12.2025"
          },
          {
            "type": "select_date",
            "label": "12.12.2025 (09:00–17:00)",
            "date": "2025-12-12",
            "display_date": "12.12.2025"
          },
          {
            "type": "ask_for_date_enqueued",
            "payload": {
              "suggested_dates": [
                "2025-12-10",
                "2025-12-11",
                "2025-12-08",
                "2025-12-09",
                "2025-12-12"
              ]
            }
          }
        ],
        "res": {
          "assistant_draft": {
            "headers_subset": [
              "Date options for Week 2 of December"
            ],
            "contains_all": [
              "Dates available in Week 2 of December 2025: 10, 11, 08, 09, 12",
              "2025-12-10 09:00–17:00"
            ]
          }
        }
      }
    },
    {
      "turn": "1a",
      "gui_action": {
        "approve_task": "ask_for_date_enqueued"
      },
      "expect": {
        "actions": [
          {
            "type": "send_reply"
          }
        ],
        "res": {
          "assistant_draft": {
            "headers_subset": [
              "Date options for Week 2 of December"
            ]
          }
        }
      }
    },
    {
      "turn": 2,
      "msg_in": {
        "body": "10.12.2025 works."
      },
      "expect": {
        "intent": "event_update",
        "user_info": {
          "date": "2025-12-10"
        },
        "actions": [
          {
            "type": "send_reply"
          },
          {
            "type": "send_reply"
          }
        ]
      }
    },
    {
      "turn": "2a",
      "system_call": "room_status_on_date",
      "args": {
        "date": "2025-12-10"
      },
      "expect": {
        "rooms_min": 3,
        "res": {
          "assistant_draft": {
            "headers": [
              "Rooms for 22 people on 10.12.2025"
            ],
            "body_order": [
              "10.12.2025 is set.",
              "For 22 people on 10.12.2025, these rooms are available (ranked):",
              "Room A",
              "Room B",
              "Room C",
              "Let me know which room you prefer"
            ],
            "contains_all": [
              "Room A — Coffee ✓ · U-shape ✓ · Projector ✓ · Capacity ✓ (max 40)",
              "Room B — Coffee ✓ · U-shape ~ · Projector ✓ · Capacity ✓ (max 60)",
              "Room C — Coffee ✗ · U-shape ✗ · Projector ~ · Capacity ✓ (max 28)"
            ]
          }
        }
      }
    },
    {
      "turn": 3,
      "msg_in": {
        "body": "Room B."
      },
      "simulate_intent": "room_choice",
      "expect": {
        "intent": "room_choice"
      }
    },
    {
      "turn": 4,
      "system_call": "build_offer",
      "args": {
        "room_id": "R-B",
        "date": "2025-12-10",
        "pax": 22
      },
      "expect": {
        "status": "Option",
        "res": {
          "assistant_draft": {
            "headers_subset": [
              "Offer"
            ],
            "contains_all": [
              "Offer sent",
              "status is Option",
              "Room B",
              "10.12.2025",
              "22 guests"
            ]
          }
        }
      }
    }
  ]
}
